<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Q1</title>
</head>

<body>
  <script>
    const userType = ["employee", "affiliate", "new"];
    const productType = ["groceries", "non-groceries"];
    const membership = [1, 3];
    const bill = [500, 1000];
    userType.forEach(ut => {
      productType.forEach(pt => {
        membership.forEach(ms => {
          bill.forEach(b => {
            const customer = user(ut, pt, ms, b);
            const billToPay = payBill(customer);
          });
        });
      });
    });

    function user(userType, productType, membership, bill) {
      return {
        userType,
        productType,
        membership,
        bill
      }
    }

    function payBill(obj) {
      /* 1. If the user is an employee of the store, he gets a 30% discount 
      2. If the user is an affiliate of the store, he gets a 10% discount 
      3. If the user has been a customer for over 2 years, he gets a 5% discount. 
      4. For every $100 on the bill, there would be a $ 5 discount (e.g. for $ 990, you get $ 45 as a discount). 
      5. The percentage based discounts do not apply on groceries. 
      6. A user can get only one of the percentage based discounts on a bill.  */

      //just for visualize
      document.write(JSON.stringify(obj));
      //end

      let isGetPercentageBaseDiscount = false;
      let percentageBaseDiscount = 0;
      let billBaseDiscount = 0;
      switch (obj.userType) {
        case "employee":
          percentageBaseDiscount = 30
          isGetPercentageBaseDiscount = true
          break;
        case "affiliate":
          percentageBaseDiscount = 10
          isGetPercentageBaseDiscount = true
          break;
      }
      if (!isGetPercentageBaseDiscount && obj.membership > 2) {
        percentageBaseDiscount = 10
        isGetPercentageBaseDiscount = true
      }
      if (isGetPercentageBaseDiscount && obj.productType === "groceries") {
        percentageBaseDiscount = 0
      }
      const billDiv = obj.bill / 100;
      billBaseDiscount = parseInt(billDiv) * 5
      const billToPay = obj.bill - ((obj.bill / 100) * percentageBaseDiscount) - billBaseDiscount

      //just for visualize
      document.write(" | bill:" + obj.bill + " percentage:" + percentageBaseDiscount + " billdiscount:" +
        billBaseDiscount);
      document.write(" --- pay : " + billToPay + "<br>");
      //end

      return billToPay;
    }
  </script>

</body>

</html>